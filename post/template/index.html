<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/xiaoxiauwu.github.io\/",
  "author": {
    "@type": "Person",
    "name": "XiaoXia",
    
    "image": "https://xiaoxiauwu.github.io/images/avatar.jpg"
    
  },
  "name":"夏のBLOG",
  "description":"",
  "url":"https:\/\/xiaoxiauwu.github.io\/post\/template\/",
  "keywords":"[tech, C\u002b\u002b, python, study]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.121.2 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="XiaoXia">
<meta name="keywords" content="tech, C&#43;&#43;, python, study">
<meta name="description" content="">


<meta property="og:description" content="">
<meta property="og:type" content="article">
<meta property="og:title" content="[ACM] 模版集（线上赛专用）（随缘更新中）">
<meta name="twitter:title" content="[ACM] 模版集（线上赛专用）（随缘更新中）">
<meta property="og:url" content="https://xiaoxiauwu.github.io/post/template/">
<meta property="twitter:url" content="https://xiaoxiauwu.github.io/post/template/">
<meta property="og:site_name" content="夏のBLOG">
<meta property="og:description" content="">
<meta name="twitter:description" content="">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2024-09-26T05:10:21">
  
  
    <meta property="article:modified_time" content="2024-09-26T05:10:21">
  
  
  
    
      <meta property="article:section" content="c&#43;&#43;">
    
      <meta property="article:section" content="模版">
    
  
  
    
      <meta property="article:tag" content="ACM">
    
      <meta property="article:tag" content="算法">
    
  


<meta name="twitter:card" content="summary">







  <meta property="og:image" content="https://xiaoxiauwu.github.io/images/avatar.jpg">
  <meta property="twitter:image" content="https://xiaoxiauwu.github.io/images/avatar.jpg">




  <meta property="og:image" content="https://s11.ax1x.com/2024/02/28/pFwZK4f.png">
  <meta property="twitter:image" content="https://s11.ax1x.com/2024/02/28/pFwZK4f.png">


  <meta property="og:image" content="https://s11.ax1x.com/2024/02/28/pFwZK4f.png">
  <meta property="twitter:image" content="https://s11.ax1x.com/2024/02/28/pFwZK4f.png">


    <title>[ACM] 模版集（线上赛专用）（随缘更新中）</title>

    <link rel="icon" href="https://xiaoxiauwu.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://xiaoxiauwu.github.io/post/template/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://xiaoxiauwu.github.io/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    
      
        <link rel="stylesheet"  href="https://xiaoxiauwu.github.io/css/codeblock.css">
      
    

    
      
    
    


<script src="https://pagead2.googlesyndication.com/pagead/managed/js/adsense/m202401110101/show_ads_impl_fy2021.js" id="google_shimpl"></script>
<script>
      MathJax = {
         tex: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            processEscapes: true,
            tags: 'ams',
         },
      };
   </script>
<script type="text/javascript" async="" src="https://wuli.wiki/MathJax3/es5/tex-mml-chtml.js"></script>

<script async src="https://xiaoxiauwu.github.io/js/busuanzi.pure.js"></script>
  <meta name="referrer" content="no-referrer-when-downgrade"></head>


<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script>
<script src="https://xiaoxiauwu.github.io/js/cp.js"></script>
<link rel="stylesheet" type="text/css" href="https://xiaoxiauwu.github.io/css/copy.css" />
  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://xiaoxiauwu.github.io/" aria-label="Go to homepage">夏のBLOG</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://xiaoxiauwu.github.io/#about" aria-label="Open the link: /#about">
    
    
    
      
        <img class="header-picture" src="https://xiaoxiauwu.github.io/images/avatar.jpg" alt="Author&#39;s picture" />
      
    
    </a>
  


<div  class="meta-item">&nbsp·&nbsp
  <span id="busuanzi_container_page_pv">本文阅读量<span id="busuanzi_value_page_pv"></span>次</span>
</div>

</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://xiaoxiauwu.github.io/#about" aria-label="Read more about the author">
          <img class="sidebar-profile-picture" src="https://xiaoxiauwu.github.io/images/avatar.jpg" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">XiaoXia</h4>
        
          <h5 class="sidebar-profile-bio">憧憬着未来却虚度着当下，到头来自己也只是一片空虚吧<strong>LIVE IN THE MOMENT</strong></h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://xiaoxiauwu.github.io/" title="Home">
    
      <i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://xiaoxiauwu.github.io/categories" title="Categories">
    
      <i class="sidebar-button-icon fas fa-lg fa-bookmark" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://xiaoxiauwu.github.io/tags" title="Tags">
    
      <i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://xiaoxiauwu.github.io/archives" title="Archives">
    
      <i class="sidebar-button-icon fas fa-lg fa-archive" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://xiaoxiauwu.github.io/#about" title="About">
    
      <i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/Xiaoxiauwu" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.totorocatcat.top" target="_blank" rel="noopener" title="Totoroの小窝">
    
      <i class="sidebar-button-icon fas fa-lg fa-link" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Totoroの小窝</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-center
              post-header-cover--full"
       style="background-image:url('https://s11.ax1x.com/2024/02/28/pFwZK4f.png')"
       data-behavior="5">
    
      <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title">
      [ACM] 模版集（线上赛专用）（随缘更新中）
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2024-09-26T05:10:21&#43;08:00">
        
  September 26, 2024

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://xiaoxiauwu.github.io/categories/c&#43;&#43;">c&#43;&#43;</a>, 
    
      <a class="category-link" href="https://xiaoxiauwu.github.io/categories/%e6%a8%a1%e7%89%88">模版</a>
    
  

  </div>

</div>
    
  </div>


      <div id="main" data-behavior="5"
        class="hasCover
               hasCoverMetaIn
               hasCoverCaption">
        <article class="post" id="top">
          
            <span class="post-header-cover-caption caption">语雀风格，爽copy板子</span>
          
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <!-- raw HTML omitted -->
<h1 id="acm模版集随缘更新中">ACM模版集（随缘更新中）</h1>
<h2 id="基础板子">基础板子</h2>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">极简模板</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">#include&lt;bits/stdc&#43;&#43;.h&gt;
using i64 = long long;
using u64 = unsigned long long;

void solve() {
    
}

signed main(){
    std::cin.tie(0) -&gt; sync_with_stdio(false);
    int t = 1;
    std::cin &gt;&gt; t;
    while(t--) solve();
    return 0;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h2 id="爬小样例cf专用">爬小样例（CF专用）</h2>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">TestCase Fetcher</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">int CNT = 0;
template &lt;typename T&gt;
std::ostream&amp; operator&lt;(std::ostream &amp;COUT, T A) {
    COUT &lt;&lt; &#34;[&#34;;
    for (int i = 0; i &lt; A.size(); i&#43;&#43;) {
        COUT &lt;&lt; A[i] &lt;&lt; &#34;,]&#34;[i == A.size() - 1];
    }
    return COUT;
}

if (&#43;&#43;CNT == 5860) {
    std::cout &lt;&lt; n &lt; a;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h2 id="杂项常用">杂项（常用）</h2>
<h3 id="sieve筛子">Sieve筛子</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Sieve</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">struct Sieve {
    std::vector&lt;int&gt; mpf; // minimum prime factor
    std::vector&lt;int&gt; prime;

    Sieve(int n) : mpf(n) {
        for (int i = 2; i &lt; n; i&#43;&#43;) {
            if (mpf[i] == 0) {
                prime.push_back(i);
                mpf[i] = i;
            }
            for (int j = 0; j &lt; prime.size() and i * prime[j] &lt; n; j&#43;&#43;) {
                mpf[i * prime[j]] = prime[j];
                if (prime[j] == mpf[i])
                    break;
            }
        }
    }

    // get all factors
    std::vector&lt;int&gt; getDiv(int x) const {
        std::vector&lt;int&gt; _div(1, 1);
        while (x &gt; 1) {
            int d = mpf[x];
            int l = 0, r = _div.size();
            while (x % d == 0) {
                for (int k = l; k &lt; r; k&#43;&#43;) {
                    _div.push_back(_div[k] * d);
                }
                x /= d;
                l = r, r = _div.size();
            }
        }
        return _div;
    }
};</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="快速幂">快速幂</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">QuickPow</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">constexpr int M = 1e9 &#43; 7;
i64 powp(i64 a, i64 n) {
    i64 ans = 1;
    while (n) {
        if (n &amp; 1) (ans *= a) %= M;
        (a *= a) %= M;
        n &gt;&gt;= 1;
    }
    return ans;
}

i64 inv(i64 x) {
    return powp(x, M - 2);
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="组合数预处理">组合数预处理</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Combination</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">i64 fac[N], invfac[N];
 
void pre() {
    fac[0] = invfac[0] = 1;
    for (int i = 1; i &lt; N; i&#43;&#43;) fac[i] = fac[i-1] * i % M;
    invfac[N - 1] = inv(fac[N - 1]);
    for (int i = N - 2; i &gt;= 1; i--) invfac[i] = invfac[i &#43; 1] * (i &#43; 1) % M;
}
 
i64 C(i64 n,i64 m) {
    if (m &gt; n) return 0;
    return fac[n] * invfac[n - m] % M * invfac[m] % M;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="随机数">随机数</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Random</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">std::mt19937_64 rng(std::chrono::steady_clock::now().time_since_epoch().count());</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h2 id="动态规划">动态规划</h2>
<h3 id="01--完全背包">01 / 完全背包</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">ZCbag</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">int ZCbag(int V, std::vector&lt;int&gt; &amp;w, std::vector&lt;int&gt; &amp;v) {//	O(nV)
    int n = w.size();
    std::vector&lt;int&gt; f(V &#43; 1);

    for (int i = 0; i &lt; n; i&#43;&#43;) {
        for (int j = V; j &gt;= w[i]; j--) {//01
        //for (int j = w[i]; j &lt;= V; j&#43;&#43;) {//完全
            f[j] = std::max(f[j], f[j - w[i]] &#43; v[i]);
        }
    }

    return f[V];
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="多重背包">多重背包</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Multibag</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">int Multibag(int V, std::vector&lt;int&gt; &amp;w, std::vector&lt;int&gt; &amp;v, std::vector&lt;int&gt; &amp;s) {//	O(nV)//单调队列优化多重背包
    int n = w.size();
	
    std::vector&lt;int&gt; f(V &#43; 1);
    std::vector&lt;int&gt; q(V &#43; 1);

    for (int i = 0; i &lt; n; i&#43;&#43;) {
        std::vector&lt;int&gt; g(f);
        for (int j = 0; j &lt; v[i]; j&#43;&#43;) {
            int h = 0, t = -1;
            for (int k = j; k &lt;= V; k &#43;= v[i]) {
                if(h &lt;= t &amp;&amp; q[h] &lt; k - s[i] * v[i]) h&#43;&#43;;//注释掉这句，可以当完全背包用，但是常数巨大，能完全背包就用完全背包，别整这些奇奇怪怪的
                while(h &lt;= t &amp;&amp; g[q[t]] - (q[t] - j) / v[i] * w[i] &lt;= g[k] - (k - j) / v[i] * w[i]) t--;
                q[&#43;&#43;t] = k;
                f[k] = g[q[h]] &#43; (k - q[h]) / v[i] * w[i];
            }
        }
    }

    return f[V];
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h2 id="数据结构">数据结构</h2>
<h3 id="树状数组">树状数组</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">BIT</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">template&lt;typename T&gt;
struct BIT {
	std::vector&lt;T&gt; a;
	int n;
	BIT(int n_) {//下标从1开始
		a.clear();
		a.resize(n_ &#43; 1);
		n = n_;
	}
	BIT() {}
	BIT(const BIT&amp; bit) {//[可选] 复制bit（很少用）
		n = bit.n;
		a = bit.a;
	}
	T getsum(int x) {//获取[1, x]的和		O(logn)
	    T s = 0;
	    while (x) {
	        s &#43;= a[x];
	        x -= (x &amp;- x);
	    }
	    return s;
	}
	void add(int x, T val) {//单点增加x处的值	O(logn)
	    while (x &lt;= n) {
	        a[x] &#43;= val;
	        x &#43;= (x &amp;- x);
	    }
	}
};
//附：想区间修改，区间查询的话，可以用这个维护差分数组（不过都只支持加减）
//区间推平，区间加乘，等操作，请换线段树</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="st表">ST表</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">ST</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">struct ST {//静态RMQ
    int n;
    std::vector&lt;std::vector&lt;int&gt;&gt; f;
    void load(std::vector&lt;int&gt; &amp;a) {
        n = a.size();
        f = std::vector&lt;std::vector&lt;int&gt;&gt;(n, std::vector&lt;int&gt;(std::log2(n) &#43; 2));
        for (int i = 0; i &lt; n; i&#43;&#43;) f[i][0] = a[i];
    }
    void work() {
        for (int j = 1; j &lt; std::log2(n) &#43; 1; j&#43;&#43;) {
            for (int i = 0; i &lt; n - (1 &lt;&lt; j) &#43; 1; i&#43;&#43;) {
                f[i][j] = std::min(f[i][j - 1], f[i &#43; (1 &lt;&lt; j - 1)][j - 1]);
            }
        }
    }
    int query(int l, int r) {//左闭右开
        r--;
        if (l &gt; r) return 1e9;//一般用不到
        int s = std::log2(r - l &#43; 1);
        return std::min(f[l][s], f[r - (1 &lt;&lt; s) &#43; 1][s]);
    }
};</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="线段树">线段树</h3>
<p>单点修改，区间查询。（可选功能：*区间查找满足条件的第一个元素，*区间查找满足条件的最后一个元素</p>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">SGT(Jiangly)</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">template&lt;class Info&gt;//	SGT template (from jiangly)
struct SGT {
    int n;//	size
    std::vector&lt;Info&gt; info;//	the info vector
    SGT() : n(0) {}//	default initialize
    SGT(int n_, Info v_ = Info()) {//	initialize with v
        init(n_, v_);
    }
    template&lt;class T&gt;
    SGT(std::vector&lt;T&gt; init_) {//	initialize with a vector
        init(init_);
    }
    void init(int n_, Info v_ = Info()) {//	initialize with v
        init(std::vector(n_, v_));
    }
    template&lt;class T&gt;
    void init(std::vector&lt;T&gt; init_) {//	initialize with a vector
        n = init_.size();
        info.assign(4 &lt;&lt; std::__lg(n), Info());
        std::function&lt;void(int, int, int)&gt; build = [&amp;](int p, int l, int r) {
            if (r - l == 1) {
                info[p] = init_[l];
                return;
            }
            int m = (l &#43; r) / 2;
            build(2 * p, l, m);
            build(2 * p &#43; 1, m, r);
            pull(p);
        };
        build(1, 0, n);
    }
    void pull(int p) {//	pull up		the way of update
        info[p] = info[2 * p] &#43; info[2 * p &#43; 1];
    }
    void modify(int p, int l, int r, int x, const Info &amp;v) {//	[original] SGT point modify
        if (r - l == 1) {
            info[p] = v;
            return;
        }
        int m = (l &#43; r) / 2;
        if (x &lt; m) {
            modify(2 * p, l, m, x, v);
        } else {
            modify(2 * p &#43; 1, m, r, x, v);
        }
        pull(p);
    }
    void modify(int p, const Info &amp;v) {//	[practice] SGT point modify
        modify(1, 0, n, p, v);
    }
    Info rangeQuery(int p, int l, int r, int x, int y) {//	[original] SGT range query
        if (l &gt;= y || r &lt;= x) {
            return Info();
        }
        if (l &gt;= x &amp;&amp; r &lt;= y) {
            return info[p];
        }
        int m = (l &#43; r) / 2;
        return rangeQuery(2 * p, l, m, x, y) &#43; rangeQuery(2 * p &#43; 1, m, r, x, y);//	can be any other way of merge.[it is suggested to customize with operator overloaded, keeping this template as a black box]
    }
    Info rangeQuery(int l, int r) {//	[practice] SGT range query
        return rangeQuery(1, 0, n, l, r);
    }
    
    //	[optional] you can ignore the following code if your don&#39;t want to use it when typing.
    template&lt;class F&gt;
    int findFirst(int p, int l, int r, int x, int y, F &amp;&amp;pred) {//	[original] range find first
        if (l &gt;= y || r &lt;= x) {
            return -1;
        }
        if (l &gt;= x &amp;&amp; r &lt;= y &amp;&amp; !pred(info[p])) {
            return -1;
        }
        if (r - l == 1) {
            return l;
        }
        int m = (l &#43; r) / 2;
        int res = findFirst(2 * p, l, m, x, y, pred);
        if (res == -1) {
            res = findFirst(2 * p &#43; 1, m, r, x, y, pred);
        }
        return res;
    }
    template&lt;class F&gt;
    int findFirst(int l, int r, F &amp;&amp;pred) {//	[practice] range find first
        return findFirst(1, 0, n, l, r, pred);
    }
    template&lt;class F&gt;
    int findLast(int p, int l, int r, int x, int y, F &amp;&amp;pred) {//	[original] range find last
        if (l &gt;= y || r &lt;= x) {
            return -1;
        }
        if (l &gt;= x &amp;&amp; r &lt;= y &amp;&amp; !pred(info[p])) {
            return -1;
        }
        if (r - l == 1) {
            return l;
        }
        int m = (l &#43; r) / 2;
        int res = findLast(2 * p &#43; 1, m, r, x, y, pred);
        if (res == -1) {
            res = findLast(2 * p, l, m, x, y, pred);
        }
        return res;
    }
    template&lt;class F&gt;
    int findLast(int l, int r, F &amp;&amp;pred) {//	[practice] range find last
        return findLast(1, 0, n, l, r, pred);
    }
};

//	the way to use it:
//	1. create a struct to record the information you want
//	2. overload the operator &#34;&#43;&#34; with this struct
//	3. declare your SGT with this struct and proper size

//	*4. when using optional function, you should declare a lambda function to check if a particular information is vaild

struct Info {//	range max
	int sum = 0;
};

Info operator&#43;(const Info &amp;a, const Info &amp;b) {
	return Info{(a.sum &#43; b.sum) % m};
}
//	LAZY的板子什么时候整理？
constexpr int N = 1 &lt;&lt; 17;//21:	2e6		17:	1e5
SGT&lt;Info&gt; sgt(N);</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="珂朵莉树">珂朵莉树</h3>
<p>当数据随机时，用于快速处理与 “区间推平” 有关的题。</p>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">珂朵莉树</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">#define IT std::set&lt;Node&gt;::iterator
struct Node{//中规中矩的珂朵莉树节点定义
    ll l,r;
    mutable ll v;
    Node(ll l,ll r=0,ll v=0):l(l),r(r),v(v){}
    bool operator&lt;(const Node &amp;a)const{
        return l&lt;a.l;
    }
};

std::set&lt;Node&gt; s;

IT split(int pos){//珂朵莉树的区间分割
    IT it=s.lower_bound(Node(pos));
    if(it!=s.end()&amp;&amp;it-&gt;l==pos){
        return it;
    }
    it--;
    if(it-&gt;r&lt;pos)return s.end();
    ll l=it-&gt;l;
    ll r=it-&gt;r;
    ll v=it-&gt;v;
    s.erase(it);
    s.insert(Node(l,pos-1,v));
    return s.insert(Node(pos,r,v)).first;
}

void add(ll l,ll r,ll x){//珂朵莉树的暴力区间加
    IT itr=split(r&#43;1),itl=split(l);//这两句是珂朵莉树经常用到的区间遍历操作
    for(IT it=itl;it!=itr;&#43;&#43;it){
        it-&gt;v&#43;=x;//这里可以任意更改，修改成其他的区间操作
    }
}

void assign(ll l,ll r,ll x){//珂朵莉树的暴力区间推平
    IT itr=split(r&#43;1),itl=split(l);
    s.erase(itl,itr);
    s.insert(Node(l,r,x));
}

ll kth(ll l,ll r,ll k){//珂朵莉树求区间第k大
    std::vector&lt;std::pair&lt;ll,ll&gt;&gt; a;
    auto itr=split(r&#43;1),itl=split(l);//先遍历一遍把区间段全取出来，然后排序
    for(IT it=itl;it!=itr;it&#43;&#43;){
        a.push_back({it-&gt;v,it-&gt;r-it-&gt;l&#43;1});
    }
    std::sort(a.begin(),a.end());

    for(auto it=a.begin();it!=a.end();it&#43;&#43;){//再暴力求区间第k大即可
        k-=it-&gt;second;
        if(k&lt;=0)return it-&gt;first;
    }
    return -1;
}

ll powp(ll x,ll n,ll p){//快速幂，和珂朵莉树无关
    ll ans=1;
    x%=p;
    while(n){
        if(n&amp;1){ans*=x;ans%=p;}
        x*=x;x%=p;n&gt;&gt;=1;
    }
    return ans;
}

ll cal(ll l,ll r,ll x,ll y){//珂朵莉树区间幂求和（其实我个人觉得这个换成更一般的操作也行，思路都是分成几块来管理
    IT itr=split(r&#43;1),itl=split(l);
    ll ans=0;
    for(IT it=itl;it!=itr;it&#43;&#43;){
        ans=(ans&#43;powp(it-&gt;v,x,y)*(it-&gt;r-it-&gt;l&#43;1)%y)%y;
    }
    return ans;
}
//======================你可以使用的接口如下：
s.insert(Node(i,i,a[i]));//初始化珂朵莉树，为每个节点赋初始值
add(l,r,x);//区间加
assign(l,r,x);//区间推平
kth(l,r,x);//区间第k大
cal(l,r,x,y);//区间求f(x)和</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="fhq-treap">FHQ Treap</h3>
<p>快速求数在数组的前驱，后继，排名（第几大），以及数组中第k大的数。同时可随意添加元素。

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">FHQ Treap</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">const int N=100005;
struct Treap
{
	const int INF;
	int Root,cnt;
	deque&lt;int&gt;del_list;
	struct Node
	{
		int ch[2],v,rnd,siz;
	}node[N];
	int newNode(int x)//申请新节点
	{
		int tmp;
		if(del_list.empty()) tmp=&#43;&#43;cnt;
		else tmp=del_list.front(),del_list.pop_front();
		node[tmp].rnd=rand(),node[tmp].v=x,node[tmp].siz=1,node[tmp].ch[0]=node[tmp].ch[1]=0;
		return tmp;
	}
	void update(int x)//更新信息
	{
		node[x].siz=node[node[x].ch[0]].siz&#43;node[node[x].ch[1]].siz&#43;1;
	}
	void vsplit(int pos,int v,int &amp;x,int &amp;y)//按权值分裂
	{
		if(!pos)
		{
			x=y=0;
			return;
		}
		if(node[pos].v&lt;=v) x=pos,vsplit(node[pos].ch[1],v,node[pos].ch[1],y);
		else y=pos,vsplit(node[pos].ch[0],v,x,node[pos].ch[0]);
		update(pos);
	}
	void ssplit(int pos,int k,int &amp;x,int &amp;y)//按size分裂
	{
		if(!pos)
		{
			x=y=0;
			return;
		}
		if(k&gt;node[node[pos].ch[0]].siz)
			x=pos,ssplit(node[pos].ch[1],k-node[node[pos].ch[0]].siz-1,node[pos].ch[1],y);
		else y=pos,ssplit(node[pos].ch[0],k,x,node[pos].ch[0]);
		update(pos);
	}
	int merge(int x,int y)//合并
	{
		if(!x||!y) return x&#43;y;
		if(node[x].rnd&lt;node[y].rnd)
		{
			node[x].ch[1]=merge(node[x].ch[1],y);
			update(x);
			return x;
		}
		node[y].ch[0]=merge(x,node[y].ch[0]);
		update(y);
		return y;
	}
	void insert(int v)//插入
	{
		int x,y;
		vsplit(Root,v,x,y);
		Root=merge(merge(x,newNode(v)),y);
	}
	void erase(int v)//删除
	{
		int x,y,z;
		vsplit(Root,v,x,z);
		vsplit(x,v-1,x,y);
		del_list.push_back(y);
		y=merge(node[y].ch[0],node[y].ch[1]);
		Root=merge(merge(x,y),z);
	}
	int pre(int v)//前驱
	{
		int x,y,cur;
		vsplit(Root,v-1,x,y);
		cur=x;
		while(node[cur].ch[1]) cur=node[cur].ch[1];
		merge(x,y);
		return node[cur].v;
	}
	int nxt(int v)//后继
	{
		int x,y,cur;
		vsplit(Root,v,x,y);
		cur=y;
		while(node[cur].ch[0]) cur=node[cur].ch[0];
		merge(x,y);
		return node[cur].v;
	}
	int get_rank(int v)//查排名
	{
		int x,y,ans;
		vsplit(Root,v-1,x,y);
		ans=node[x].siz;
		merge(x,y);
		return ans;
	}
	int kth(int k)//查排名为k的数
	{
		&#43;&#43;k;
		int x,y,cur;
		ssplit(Root,k,x,y);
		cur=x;
		while(node[cur].ch[1]) cur=node[cur].ch[1];
		merge(x,y);
		return node[cur].v;
	}
	Treap():INF(2147483647)//构造函数初始化
	{
		Root=cnt=0;
		insert(-INF),insert(INF);
	}
};
//使用例：
int main(){
    ios::sync_with_stdio(0);cin.tie(0);cout.tie(0);
    Treap T;//声明对象
    int n,t,x;
    cin&gt;&gt;n;
    while(n--){
        cin&gt;&gt;t&gt;&gt;x;
        if(t==1)cout&lt;&lt;T.get_rank(x)&lt;&lt;ET;//排名
        else if(t==2)cout&lt;&lt;T.kth(x)&lt;&lt;ET;//第x大的数
        else if(t==3)cout&lt;&lt;T.pre(x)&lt;&lt;ET;//前驱
        else if(t==4)cout&lt;&lt;T.nxt(x)&lt;&lt;ET;//后继
        else T.insert(x);//插入
    }
    return 0;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details></p>
<h3 id="莫队">莫队</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">莫队(空模版)</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">struct MD {//（离线莫队）
    struct query {
        int id;
        int l;
        int r;
    };
    std::vector&lt;query&gt; q;//m &#43; 1
    std::vector&lt;int&gt; a;//n &#43; 1
    int n, m, block;

    //[Editable] 你想维护的各种信息
    std:::vector&lt;int&gt; ans;
    //==========================//

    void add(int v) {//[Editable] 维护添加操作

    }
    void del(int v) {//[Editable] 维护删除操作

    }
    
    void init(const std::vector&lt;int&gt; &amp;A, const std::vector&lt;std::pair&lt;int, int&gt;&gt; &amp;Q) {//初始化（一般不变）（传入数组下标都从0开始，询问数组的元素范围:[1, n]）
        n = A.size();
        a.resize(n &#43; 1);

        block = std::sqrt(n);
        for(int i = 1; i &lt;= n; i&#43;&#43;) a[i] = A[i - 1];
        
        m = Q.size();
        q.resize(m);

        //[Editable] 维护信息初始化
        ans.resize(q);
        //==========================//

        for(int i = 0; i &lt; m; i&#43;&#43;) {
            q[i].id = i;
            q[i].l = Q[i].first;
            q[i].r = Q[i].second;
        }
        std::sort(q.begin(), q.end(), [&amp;](query a, query b) {//按块排序
            int al = a.l / block, bl = b.l / block;
            int ar = a.r / block, br = b.r / block;
            if(al != bl) return al &lt; bl;
            return ar &lt; br;
        });
    }
 
    void work() {// 模拟过程
        int l, r, cl, cr;
        cr = 1;
        cl = 1;
        add(a[1]);
        for(int i = 0; i &lt; m; i&#43;&#43;)
        {
            l = q[i].l, r = q[i].r;
            while(cr &lt; r) add(a[&#43;&#43;cr]);
            while(cl &gt; l) add(a[--cl]);
            while(cr &gt; r) del(a[cr--]);
            while(cl &lt; l) del(a[cl&#43;&#43;]);
            //[Editable] 统计答案
            ans[q[i].id] = 
            //====================//
        }
    }
    
    int getans(int i) {//[Editable] 获取答案（记得改返回类型）
        return ans[i];
    }
};</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">莫队(区间众数)</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">struct MD {//区间众数（离线莫队）
	struct query {
		int id;
		int l;
		int r;
	};
	std::vector&lt;query&gt; q;//m &#43; 1
	std::vector&lt;int&gt; a;//n &#43; 1
	int n, m, block;
	
	//[Editable] 你想维护的各种信息
	std::vector&lt;int&gt; cnt, sum, ans;//n &#43; 1
	int max_cnt = 0;
	void add(int e) {//[Editable] 维护添加操作
		sum[cnt[e]]--;
		cnt[e]&#43;&#43;;
		sum[cnt[e]]&#43;&#43;;
		max_cnt = std::max(max_cnt, cnt[e]);
	}
	void del(int e) {//[Editable] 维护删除操作
		sum[cnt[e]]--;
		if(cnt[e] == max_cnt &amp;&amp; sum[cnt[e]] == 0) max_cnt--;
		cnt[e]--;
		sum[cnt[e]]&#43;&#43;;
	}
	
	void init(const std::vector&lt;int&gt; &amp;A, const std::vector&lt;std::pair&lt;int, int&gt;&gt; &amp;Q) {//初始化（一般不变）（传入数组下标都从0开始，询问数组的元素范围:[1, n]）
		n = A.size();
		a.resize(n &#43; 1);
		
		cnt = a; sum = a; ans = a;//	维护信息初始化
		block = std::sqrt(n);
		for(int i = 1; i &lt;= n; i&#43;&#43;) a[i] = A[i - 1];
		
		m = Q.size();
		q.resize(m);
		for(int i = 0; i &lt; m; i&#43;&#43;) {
			q[i].id = i;
			q[i].l = Q[i].first;
			q[i].r = Q[i].second;
		}
		std::sort(q.begin(), q.end(), [&amp;](query a, query b) {//按块排序
			int al = a.l / block, bl = b.l / block;
			int ar = a.r / block, br = b.r / block;
			if(al != bl) return al &lt; bl;
			return ar &lt; br;
		});
	}
 
	void work() {//[Editable] 处理答案
		int l, r, cl, cr;
		cl = cr = 0;
		add(a[0]);
		for(int i = 0; i &lt; m; i&#43;&#43;)
		{
			l = q[i].l, r = q[i].r;
			while(cr &lt; r) add(a[&#43;&#43;cr]);
			while(cl &gt; l) add(a[--cl]);
			while(cr &gt; r) del(a[cr--]);
			while(cl &lt; l) del(a[cl&#43;&#43;]);
			ans[q[i].id] = max_cnt;
		}
	}
	
	int getans(int i) {//按询问下标获取答案
		return ans[i];
	}
};</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">莫队(区间本质不同数的奇偶性)</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">struct MD {//区间本质不同数的奇偶性（离线莫队）
    struct query {
        int id;
        int l;
        int r;
    };
    std::vector&lt;query&gt; q;//m &#43; 1
    std::vector&lt;int&gt; a;//n &#43; 1
    int n, m, block;
    
    //[Editable] 你想维护的各种信息
    std::vector&lt;std::string&gt; ans;
    std::vector&lt;int&gt; cnt; 
    int bad = 0;

    void add(int v) {//[Editable] 维护添加操作
        if (cnt[v] &amp; 1) bad--;
        else bad&#43;&#43;;
        cnt[v]&#43;&#43;;
    }
    void del(int v) {//[Editable] 维护删除操作
        if (cnt[v] &amp; 1) bad--;
        else bad&#43;&#43;;
        cnt[v]--;
    }
    
    void init(const std::vector&lt;int&gt; &amp;A, const std::vector&lt;std::pair&lt;int, int&gt;&gt; &amp;Q) {//初始化（一般不变）（传入数组下标都从0开始，询问数组的元素范围:[1, n]）
        n = A.size();
        a.resize(n &#43; 1);

        block = std::sqrt(n);
        for(int i = 1; i &lt;= n; i&#43;&#43;) a[i] = A[i - 1];
        
        m = Q.size();
        q.resize(m);

        //[Editable] 维护信息初始化
        cnt = A;
        std::sort(cnt.begin(), cnt.end());
        cnt.erase(std::unique(cnt.begin(), cnt.end()), cnt.end());
        std::map&lt;int, int&gt; mp;
        for (int i = 0; i &lt; cnt.size(); i&#43;&#43;) {
            mp[cnt[i]] = i;
        }
        for (int i = 1; i &lt;= n; i&#43;&#43;) {
            a[i] = mp[a[i]];
        }
        ans.resize(m &#43; 1);
        cnt.clear();
        cnt.resize(mp.size());
        //==========================//

        for(int i = 0; i &lt; m; i&#43;&#43;) {
            q[i].id = i;
            q[i].l = Q[i].first;
            q[i].r = Q[i].second;
        }
        std::sort(q.begin(), q.end(), [&amp;](query a, query b) {//按块排序
            int al = a.l / block, bl = b.l / block;
            int ar = a.r / block, br = b.r / block;
            if(al != bl) return al &lt; bl;
            return ar &lt; br;
        });
    }
 
    void work() {//[Editable] 处理答案
        int l, r, cl, cr;
        cr = 1;
        cl = 1;
        add(a[1]);
        for(int i = 0; i &lt; m; i&#43;&#43;)
        {
            l = q[i].l, r = q[i].r;
            while(cr &lt; r) add(a[&#43;&#43;cr]);
            while(cl &gt; l) add(a[--cl]);
            while(cr &gt; r) del(a[cr--]);
            while(cl &lt; l) del(a[cl&#43;&#43;]);
            //[Editable] 统计答案
            ans[q[i].id] = (bad == 0 ? &#34;YES&#34; : &#34;NO&#34;);
        }
    }
    
    std::string getans(int i) {//按询问下标获取答案
        return ans[i];
    }
};</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="线性基">线性基</h3>
<p><em>为什么放到数据结构里？因为我觉得它很像数据结构</em></p>
<p>给定集合，维护子集元素异或和最大值，最小值，是否存在某个子集异或和为x，子集异或和第k大，子集异或和排名</p>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">LineBasis</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">struct LB {
    i64 p[64] = {0};
    int cnt = 0, top = 0;
    int MB = 63;//小卡一下常（设定上界）
    bool haszero = 0;
    LB(){}
    template&lt;typename T&gt;
    LB(T &amp;a) {//快速初始化（可以没有）
        for (auto &amp;i : a) push(i);
    }
    void push(i64 x) {//追加元素
        if (x == 0 || contain(x)) haszero = 1;
        for (int i = 63; i &gt;= 0; i--) {
            if (x &amp; (1ll &lt;&lt; i)) {
                if (!p[i]) {
                    p[i] = x;
                    cnt&#43;&#43;;
                    break;
                } else {
                    x ^= p[i];
                }
            }
        }
    }
    bool contain(i64 x) {//是否能线性异或出x
        if (x == 0) return zero();
        for (int i = 63; i &gt;= 0; i--) {
            if (x &amp; (1ll &lt;&lt; i)) x ^= p[i];
        }
        return x == 0;
    }
    bool zero() {
        return haszero;
    }
    i64 max() {//[可选]最大值
        i64 ans = 0;
        for (int i = 63; i &gt;= 0; i--) {
            if ((ans ^ p[i]) &gt; ans) ans ^= p[i];
        }
        return ans;
    }
    i64 min() {//[可选]最小值
        if (zero()) return 0;
        for (int i = 0; i &lt;= 63; i&#43;&#43;) {
            if (p[i]) return p[i];
        }
    }

    i64 d[64] = {0};
    void kth_pre() {//[可选/必选（如果要求kth和rank）]第k大-预处理
        cnt = 0;
        top = 0;
        for (int i = MB; i &gt;= 0; i--) {
            for (int j = i - 1; j &gt;= 0; j--) {
                if (p[i] &amp; (1ll &lt;&lt; j)) p[i] ^= p[j];
            }
        }
        for (int i = 0; i &lt;= MB; i&#43;&#43;) {
            if (p[i]) d[cnt&#43;&#43;] = p[i];
        }
    }
    i64 kth(int k) {//[可选]第k小（下标从1开始）
        k--;
        if (!zero()) k&#43;&#43;;
        if (k &gt;= (1ll &lt;&lt; cnt)) return -1;
        i64 ans = 0;
        for (int i = MB; i &gt;= 0; i--) {
            if (k &amp; (1ll &lt;&lt; i)) ans ^= d[i];
        }
        return ans;
    }
    i64 rank(i64 x) {//[可选]排名（从小到大，下标从1开始）（如果要查询的数不能被线性异或出，返回的将是“线性基中第一个小于该数的排名”）
        i64 ans = 0;
        for (int i = cnt - 1; i &gt;= 0; i--) {
            if (x &gt;= d[i]) {
                ans &#43;= (1ll &lt;&lt; i);
                x ^= d[i];
            }
        }
        return ans &#43; zero();
    }
};</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="并查集">并查集</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">极简并查集</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">const int N=100005;
int F[N];
int find(int x){//查询，自带路径压缩
    return x==F[x]?x:F[x]=find(F[x]);
}
void join(int x,int y){//合并集合
    F[find(x)]=find(y);
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">并查集（模板类）</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">template&lt;typename T&gt;
struct BCJ{
    map&lt;T,T&gt; F;//使用map储存集合关系
    BCJ(){}
    void reset(){F.clear();}//重置，进行下一回合操作
    void init(T x){mp[x]=x;}//需要自己手动初始化
    T find(T x){//溯源
        if(F[x]!=x){
            F[x]=find(F[x]);
        }
        return F[x];
    }
    void join(T x,T y){//合并集合
        T Fx=find(x),Fy=find(y);
        if(Fx!=Fy){
            F[Fx]=Fy;
        }
    }
};</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">带权并查集</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">const int N=100005;
int F[N],val[N];
int find(int x){
    if(F[x]!=x){
        int t=F[x];//暂存其亲戚
        F[x]=find(F[x]);
        val[x]&#43;=val[t];
        //合并之前是val[x]=x-&gt;t，val[t]=t-&gt;Ft
        //所以合并后val[x]应&#43;=val[t]（要让x直接连到Ft那边，权值自然得加上val[t]
        //不一定是相加。还要看具体的题目，有些题目甚至要求你不止维护一种权值
    }
    return F[x];
}
void join(int x,int y,int v){
    int Fx=find(x),Fy=find(y);
    if(Fx!=Fy){
        F[Fx]=Fy;
        val[Fx]=v&#43;val[y]-val[x];
        //理解成向量加减法，假设x和y的亲戚均不为自己，那么有如下关系：
        //y-&gt;Fy
        //↑  ↑
        //x-&gt;Fx
        //由向量加法知：x-&gt;y-&gt;ry路径上的“权值和”等于x-&gt;rx-&gt;ry上的“权值和”
        //所以val[Fx]应等于v&#43;val[y]-val[x]
        //不一定是简单加减，只是举个例子方便理解，实际还得具体题目具体分析
    }
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="pbdstree">pbdsTree</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">pbdsTree</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">#include &lt;ext/pb_ds/assoc_container.hpp&gt;
#include &lt;ext/pb_ds/tree_policy.hpp&gt;

namespace pb = __gnu_pbds;

template &lt;class T, class Cmp = std::less&lt;T&gt;&gt;
using RedBlackTree =
    pb::tree&lt;T, pb::null_type, Cmp, pb::rb_tree_tag,
             pb::tree_order_statistics_node_update&gt;;

/**
 * order_of_key(x) -&gt; 查询有多少元素比x小
 * find_by_order(x) -&gt; 查询第x个元素的迭代器
 */</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h2 id="图论">图论</h2>
<h3 id="kruskal">Kruskal</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Kruskal</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">struct node{//点类
	int u,v,w;
    bool operator&lt;(const &amp;node a){
        return a.w&lt;b.w;
    }
}edge[200005];

int f[5005];
int find(int x){
	while(x!=f[x])x=f[x]=f[f[x]];
	return x;
}//并查集与路径压缩

void kruskal(){
	sort(edge,edge&#43;m);
	int cnt=0;
	for(int i=0;i&lt;m;i&#43;&#43;){//多理解一下
		int u=find(edge[i].u),v=find(edge[i].v);
		if(u==v)continue;
		ans&#43;=edge[i].w;
		f[v]=u;
		if(&#43;&#43;cnt==n-1)break;
	}
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="dijkstra">dijkstra</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Dijkstra</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">void dijkstra(std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt;&gt;&gt; &amp;graph, int source, std::vector&lt;int&gt; &amp;dist) {
	//	原始图，源，到源的距离
	int n = graph.size();
	std::vector&lt;bool&gt; vis(n);
	dist.resize(n);
	std::fill(dist.begin(), dist.end(), 1e9);
	
    dist[source] = 0;
    std::priority_queue&lt;std::pair&lt;int, int&gt;, std::vector&lt;std::pair&lt;int, int&gt;&gt;, std::greater&lt;std::pair&lt;int, int&gt;&gt;&gt; pq;
    pq.push({0, source});
    while (!pq.empty()){
        int node = pq.top().second;
        int cost = pq.top().first;
        pq.pop();
        if (vis[node]) continue;
        vis[node] = 1;
        //if (cost &gt; dist[node])continue;
        for (auto &amp;edge : graph[node]) {
            int to = edge.first;
            int weight = edge.second;
            if (weight &#43; dist[node] &lt; dist[to]) {
                dist[to] = weight &#43; dist[node];
                if (!vis[to]) pq.push({dist[to], to});
            }
        }
    }
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h2 id="树论">树论</h2>
<h3 id="重链剖分">重链剖分</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Heave-Light Decomposition</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">struct HLD {//	Heave-Light Decomposition(with 0 as the root)
    int n;
    std::vector&lt;int&gt; siz, top, dep, parent, in, out, seq;
    std::vector&lt;std::vector&lt;int&gt;&gt; adj;
    int cur;
    
    HLD() {}
    HLD(int n) {
        init(n);
    }
    void init(int n) {
        this-&gt;n = n;
        siz.resize(n);
        top.resize(n);
        dep.resize(n);
        parent.resize(n);
        in.resize(n);
        out.resize(n);
        seq.resize(n);
        cur = 0;
        adj.assign(n, {});
    }
    void addEdge(int u, int v) {
        adj[u].push_back(v);
        adj[v].push_back(u);
    }
    //	work out the infomation of tree
    void work(int root = 0) {
        top[root] = root;
        dep[root] = 0;
        parent[root] = -1;
        dfs1(root);
        dfs2(root);
    }
    //	get the size of subtree
    void dfs1(int u) {
        if (parent[u] != -1) {
            adj[u].erase(std::find(adj[u].begin(), adj[u].end(), parent[u]));
        }
        
        siz[u] = 1;
        for (auto &amp;v : adj[u]) {
            parent[v] = u;
            dep[v] = dep[u] &#43; 1;
            dfs1(v);
            siz[u] &#43;= siz[v];
            if (siz[v] &gt; siz[adj[u][0]]) {
                std::swap(v, adj[u][0]);
            }
        }
    }
    //	HLD
    void dfs2(int u) {
        in[u] = cur&#43;&#43;;
        seq[in[u]] = u;
        for (auto v : adj[u]) {
            top[v] = v == adj[u][0] ? top[u] : v;
            dfs2(v);
        }
        out[u] = cur;
    }
    //	get lca with 1 as root
    int lca(int u, int v) {
        while (top[u] != top[v]) {
            if (dep[top[u]] &gt; dep[top[v]]) {
                u = parent[top[u]];
            } else {
                v = parent[top[v]];
            }
        }
        return dep[u] &lt; dep[v] ? u : v;
    }
    //	get distance
    int dist(int u, int v) {
        return dep[u] &#43; dep[v] - 2 * dep[lca(u, v)];
    }
    //	find the kth ancester of u
    int jump(int u, int k) {
        if (dep[u] &lt; k) {//	nonexist
            return -1;
        }
        
        int d = dep[u] - k;
        
        while (dep[top[u]] &gt; d) {
            u = parent[top[u]];
        }
        
        return seq[in[u] - dep[u] &#43; d];
    }
    //	u is the ancester of v
    bool isAncester(int u, int v) {
        return in[u] &lt;= in[v] &amp;&amp; in[v] &lt; out[u];
    }
    //	get the parent with v as new root
    int rootedParent(int u, int v) {
        std::swap(u, v);
        if (u == v) {
            return u;
        }
        if (!isAncester(u, v)) {
            return parent[u];
        }
        auto it = std::upper_bound(adj[u].begin(), adj[u].end(), v, [&amp;](int x, int y) {
            return in[x] &lt; in[y];
        }) - 1;
        return *it;
    }
    //	get the size of subtree with v as new root
    int rootedSize(int u, int v) {
        if (u == v) {
            return n;
        }
        if (!isAncester(v, u)) {
            return siz[v];
        }
        return n - siz[rootedParent(u, v)];
    }
    //	get the lca of a and b with v as new root
    int rootedLca(int a, int b, int c) {
        return lca(a, b) ^ lca(b, c) ^ lca(c, a);
    }
};
//USE:
HDL tr(n &#43; 1);
tr.addEdge(1, 2);
tr.work();</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h2 id="字符串">字符串</h2>
<p>
  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">KMP</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">auto kmp(const std::string &amp;s) {
    int n = s.size();
    std::vector&lt;int&gt; link(n);
    for (int i = 1, j = 0; i &lt; n; i&#43;&#43;) {
        while (j and s[i] != s[j])
            j = link[j - 1];
        j &#43;= (s[i] == s[j]);
        link[i] = j;
    }
    return link;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Manacher</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">//给定一个字符串，该算法可以在 $O(n)$ 的复杂度下处理出该字符串每点的最大回文半径。
vector&lt;int&gt; manacher(string s) {//返回的R数组每项减1才是答案
    string t=&#34;#&#34;;
    for(auto c:s){t&#43;=c;t&#43;=&#39;#&#39;;}
    int n=t.size();
    vector&lt;int&gt; r(n);
    for(int i=0,j=0;i&lt;n;i&#43;&#43;){
        if(2*j-i&gt;=0&amp;&amp;j&#43;r[j]&gt;i)r[i]=min(r[2*j-i],j&#43;r[j]-i);
        while(i-r[i]&gt;=0&amp;&amp;i&#43;r[i]&lt;n&amp;&amp;t[i-r[i]]==t[i&#43;r[i]])r[i]&#43;=1;
        if(i&#43;r[i]&gt;j&#43;r[j])j=i;
    }
    return r;
}
vector&lt;int&gt; PR;
inline bool PAL(int l,int r){//判回文串（原理：判以(l&#43;r)/2为中心的回文半径是否为l到r的长度）
    return PR[r&#43;l-1]-1==(r-l&#43;1);//为什么要减一，看看上面的马拉车开头部分
    //注意，这里双等号表示所求目标回文串不能是任何其他回文串的中心
    //改成&gt;=的话，就可以略去以上条件
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details></p>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">字符串单哈希 (来自Hireathsoul，可能有点慢，不知道是不是base取太大了)</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">//给定一个字符串，O(n)预处理，O(1)下判断字符串子串相等的工具

mt19937_64 rnd((ull)time(0));//随机数
ll hshb[]={2663545921,1000000019,1000000033,1000000061,1000000069,1000000097};
struct HASH{//带前导无效字符，下标从1开始
    int n;
    std::vector&lt;ll&gt; hsh,H;
    ll p,base;
    HASH(const std::string &amp;s):n(s.size()),hsh(n),H(n){
        base=hshb[rnd()%6];//随机模数，防止被卡
        p = 1234567891;
        hsh[0] = 1;
        for (int i = 1; i &lt;= n - 1; &#43;&#43;i){
            hsh[i] = hsh[i - 1] * base % p;
            H[i] = (H[i - 1] * base % p &#43; s[i]) % p;
        }
    }
    ll query(int l, int r){
        return (H[r] - H[l - 1] * hsh[r - l &#43; 1] % p &#43; p) % p;
    }
};</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<p>
  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">字符串双哈希（来自GWTM）</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">struct Shash{  
    const ll base[2]={29,31};
    const ll hashmod[2]={(ll)1e9&#43;9,998244353};
    array&lt;vector&lt;ll&gt;,2&gt;hsh;
    array&lt;vector&lt;ll&gt;,2&gt;pwMod;
    void init(string S){//传入时不需要加前导空字符，会自动加，下标从1开始
        int n=S.size();S=&#39; &#39;&#43;S;
        hsh[0].resize(n&#43;1),hsh[1].resize(n&#43;1);
        pwMod[0].resize(n&#43;1),pwMod[1].resize(n&#43;1);
        for(int i=0;i&lt;2;&#43;&#43;i){
            pwMod[i][0]=1;
            for (int j=1;j&lt;=n;&#43;&#43;j){
                pwMod[i][j]=pwMod[i][j-1]*base[i]%hashmod[i];
                hsh[i][j]=(hsh[i][j-1]*base[i]&#43;S[j])%hashmod[i];
            }
        }
    }
    pair&lt;ll,ll&gt;get(int l,int r){
        pair&lt;ll,ll&gt; ans;
        ans.first=(hsh[0][r]-hsh[0][l-1]*pwMod[0][r-l&#43;1])%hashmod[0];
        ans.second=(hsh[1][r]-hsh[1][l-1]*pwMod[1][r-l&#43;1])%hashmod[1];
        ans.first=(ans.first&#43;hashmod[0])%hashmod[0];
        ans.second=(ans.second&#43;hashmod[1])%hashmod[1];
        return ans;
    }
};
bool same(Shash &amp;a,int la,int ra,Shash &amp;b,int lb,int rb){//查询
    return a.get(la,ra)==b.get(lb,rb);
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">字符串N哈希（来自Capps）</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">template &lt;int D, std::array&lt;int, D&gt; B, std::array&lt;int, D&gt; P&gt;
struct StringHash {
    std::vector&lt;std::array&lt;int, D&gt;&gt; h;

    template &lt;class T&gt;
    StringHash(const T &amp;s) : h(s.size() &#43; 1) {
        for (int i = 0; i &lt; s.size(); i&#43;&#43;) {
            for (int k = 0; k &lt; D; k&#43;&#43;) {
                h[i &#43; 1][k] = (1ll * h[i][k] * B[k] &#43; s[i] &#43; 1) % P[k];
            }
        }
    }

    // [l, r)
    std::array&lt;int, D&gt; get(int l, int r) {
        static std::vector&lt;std::array&lt;int, D&gt;&gt; spow(1);
        if (r - l &lt; 0)
            throw -1;

        if (spow.size() &lt; r - l &#43; 1) {
            if (spow[0][0] == 0) {
                spow[0].fill(1);
            }
            int n = spow.size();
            spow.resize(r - l &#43; 1);
            for (int i = n; i &lt; spow.size(); i&#43;&#43;) {
                for (int k = 0; k &lt; D; k&#43;&#43;) {
                    spow[i][k] = 1ll * spow[i - 1][k] * B[k] % P[k];
                }
            }
        }

        std::array&lt;int, D&gt; res = {};
        for (int k = 0; k &lt; D; k&#43;&#43;) {
            res[k] = h[r][k] - 1ll * h[l][k] * spow[r - l][k] % P[k];
            res[k] &#43;= (res[k] &lt; 0 ? P[k] : 0);
        }
        return res;
    }
};
using Hash = StringHash&lt;2, {133, 331}, {int(1e9 &#43; 21), int(1e9 &#43; 33)}&gt;;</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">zFunction</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">//O(1)查询字符串以各个下标为起始下标时，最大的前缀匹配长度，

auto zFunction(const std::string &amp;s) {
    int n = s.size();
    std::vector&lt;int&gt; z(n);
    for (int i = 1, l = 0, r = 0; i &lt; n; i&#43;&#43;) {
        if (i &lt; r)
            z[i] = min(z[i - l], r - i);
        while (i &#43; z[i] &lt; n and s[i &#43; z[i]] == s[z[i]])
            z[i]&#43;&#43;;
        if (i &#43; z[i] &gt; r)
            l = i, r = i &#43; z[i];
    }
    z[0]=n;
    return z;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details></p>
<h2 id="数学">数学</h2>
<h3 id="归并排序">归并排序</h3>
<p>排序，求逆序数</p>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Merge Sort</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">template&lt;typename T&gt;
struct MGST {
	T q, tmp;
	MGST(T&amp; a_) {
		q = a_;
		tmp = a_;
	}
	i64 solve(int l, int r) {
	    if (l &gt;= r)
	        return 0;
	    int mid = l &#43; r &gt;&gt; 1;
	    i64 ans = solve(l, mid) &#43; solve(mid &#43; 1, r);
	    int i = l, j = mid &#43; 1, k = l;
	    while (i &lt;= mid &amp;&amp; j &lt;= r) {
	        if (q[i] &lt;= q[j])//特别要注意这个，虽然加不加等号对于排序而言并没有影响，但是求逆序数时，加不加等于号是两种情况。只有在严格大于的时候才是逆序数。
	            tmp[k&#43;&#43;] = q[i&#43;&#43;];
	        else {
	            tmp[k&#43;&#43;] = q[j&#43;&#43;];
	            ans &#43;= (mid - i &#43; 1);
	        }
	    }
	    while (i &lt;= mid)
	        tmp[k&#43;&#43;] = q[i&#43;&#43;];
	    while (j &lt;= r)
	        tmp[k&#43;&#43;] = q[j&#43;&#43;];
	    for (int i = l; i &lt;= r; i&#43;&#43;)
	        q[i] = tmp[i];
	    return ans;
	}
};</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="容斥定理">容斥定理</h3>
<p>非常简单的概念，集合学过吧，$A\bigcup B\bigcup C=A+B+C-(A\bigcap B)-(B\bigcap C)-(A\bigcap C)+(A\bigcap B\bigcap C)$，差不多就是这样的原理。</p>
<p>常用位运算进行集合操作，下面给出的是利用容斥定理求n以内与n不互质的数的个数的算法。$O(2^n)$（$n$ 为质因数个数）</p>
<pre><code class="language-cpp">ll cnt=d.size();//分解质因数的结果，不含1
ll ans=0;
for(ll i=1;i&lt;(1&lt;&lt;cnt);i++){//
    ll mul=1,num=0;
    FOR(j,0,cnt-1){//
        if(i&amp;(1&lt;&lt;j)){//
            num++;mul*=d[j];
        }
    }
    if(num&amp;1)ans+=n/mul;//
    else ans-=n/mul;//
}
</code></pre>
<h3 id="矩阵快速幂">矩阵快速幂</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Matrix</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">ll M=10000;
class Matrix{
public:
    int n,m;
    vector&lt;vector&lt;ll&gt; &gt; a;
    Matrix(int n_,int m_){
        n=n_;m=m_;
        a=vector&lt;vector&lt;ll&gt; &gt;(n&#43;1,vector&lt;ll&gt;(m&#43;1,0));
    }
    Matrix(vector&lt;vector&lt;ll&gt; &gt; tmp){//快速创建矩阵（为什么C&#43;&#43;98用不了brace-init啊）
        n=tmp.size();m=tmp[0].size();
        a=vector&lt;vector&lt;ll&gt; &gt;(n&#43;1,vector&lt;ll&gt;(m&#43;1,0));
        FOR(i,1,n)FOR(j,1,m)a[i][j]=tmp[i-1][j-1];
    }
    vector&lt;ll&gt;&amp; operator[](ll i){//重载运算符
        return a[i];
    }
    Matrix operator*(Matrix b){//矩阵求积
        Matrix tmp(n,b.m);
        FOR(i,1,n)FOR(j,1,b.m)FOR(k,1,m){
            tmp[i][j]&#43;=a[i][k]*b[k][j];
            tmp[i][j]%=M;
        }
        return tmp;
    }
    Matrix operator^(ll n){//快速幂
        Matrix a=*this,ans=a;ans=1;
        while(n){
            if(n&amp;1)ans=ans*a;
            a=a*a;
            n&gt;&gt;=1;
        }
        return ans;
    }
    void operator=(ll n){//单位矩阵
        FOR(i,1,n)FOR(j,1,m)a[i][j]=(i==j)*n;
    }
    //====接下来是一些和快速幂无关的函数
    Matrix T(){//矩阵求转置
        Matrix tmp(m,n);
        FOR(i,1,n)FOR(j,1,m)tmp[j][i]=a[i][j];
        return tmp;
    }
    void print(){//测试输出用，可以不写
        FOR(i,1,n)FOR(j,1,m)cout&lt;&lt;a[i][j]&lt;&lt;&#34; \n&#34;[j==m];
    }
};
/*
//用法举例：
Matrix a(2,2);
a[1][1]=1;a[1][2]=1;
a[2][1]=1;a[2][2]=0;
cout&lt;&lt;(a^n)[1][2];//求斐波那契第n项（模M）

Matrix b({  {1,2,3},
            {4,5,6} });
(b*(b.T())).print();//矩阵乘法
*/</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="gcd">gcd</h3>
<p>求两数间最大公约数 $\gcd(x,y)$</p>
<pre><code class="language-cpp">ll gcd(ll a, ll b){
    if(b == 0)return a;
    return gcd(b, a % b);
}
//当然你也可以直接#include&lt;algorithm&gt;，然后用：
__gcd(x,y);
</code></pre>
<h3 id="exgcd扩展欧几里得">exgcd，扩展欧几里得</h3>
<p>先了解裴蜀(贝祖)定理</p>
<p>裴蜀(贝祖)定理：若 $a,b$ 是整数,且 $\gcd(a,b)=d$，那么对于任意的整数 $x$、$y$，$ax+by$ 都一定是 $d$ 的倍数，特别地，一定存在整数 $x,y$，使 $ax+by=d$ 成立。
同时可知对于一般方程 $ax+by=c$ 有解的条件为 $\color{#ff6666}{c\equiv0~(mod~\gcd(a,b))}$。</p>
<p>拓展gcd即是要求 $ax+by=\gcd(a,b)$ 中 $x$、$y$ 的整数解</p>
<p>设有 $ax+by=\gcd(a,b)$，显然，当 $b = 0$ 时，$\gcd(a,b) = a$，$x = 1$，$y = 任何数$。为了方便这里使 $y = 0$。
当 $b \ne 0$ 时</p>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">EXGCD</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">i64 ex_gcd(i64 a, i64 b, i64 &amp;x, i64 &amp;y) {
	if(!b) {
		x = 1;
		y = 0;
		return a;
	}
	i64 g = ex_gcd(b, a%b, x, y);
	i64 t = x;
	x = y;
	y = t - a / b * y;
	return g;//这里返回的是gcd(a,b)
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="bgsg">BGSG</h3>
<p>求解高次同余方程

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">BSGS</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">i64 BSGS(i64 a,i64 b,i64 m){//求解a^x = b mod m
	unordered_map&lt;i64, i64&gt; mp;
	i64 r = b * a % m, t = sqrt(m) &#43; 1;
	for(int B = 1; B &lt;= t; B&#43;&#43;){
		mp[r] = B;
		r = (r * a) % m;
	}
	i64 at = powp(a, t, m), l = at;
	for(int A = 1; A &lt;= t; A&#43;&#43;){
		if (mp[l]) return A * t - mp[l];
		l = (l * at) % m; 
	}
	return -1; 
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details></p>
<h3 id="catalan数">Catalan数</h3>
<p>$Catalan$ 数经常出现在组合计数的问题中，本质上和栈操作有关</p>
<p>下面直接放出 $Catalan$ 数的4个公式：</p>
<p>基本定义式：</p>
<p>$$CTL_n=\sum_{i=1}^{n}CTL_i\cdot CTL_{n-i}$$</p>
<p>递推式：</p>
<p>$$CTL_n=\frac{(4n-2)CTL_{n-1}}{n+1}$$</p>
<p>组合通项式：</p>
<p>$$CTL_n=\frac{\textrm{C}^n_{2n}}{n+1}$$</p>
<p>组合通项式2：</p>
<p>$$CTL_n=\textrm{C}^n_{2n}-\textrm{C}^{n-1}_{2n}$$</p>
<p>为什么要记这么多式子？当然是推式子化简需要。</p>
<h2 id="计算几何">计算几何</h2>
<p>基本来自Capps</p>
<h3 id="点二维">点（二维）</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Point</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">template &lt;class T, class G&gt;
struct BaseVector2 {
    T x, y;
    constexpr BaseVector2() : BaseVector2(T{}, T{}) {}
    constexpr BaseVector2(T x, T y) : x{x}, y{y} {}

    // 运算
    constexpr BaseVector2 operator&#43;(BaseVector2 a) const {
        return BaseVector2(x &#43; a.x, y &#43; a.y);
    }
    constexpr BaseVector2 operator-(BaseVector2 a) const {
        return BaseVector2(x - a.x, y - a.y);
    }
    constexpr BaseVector2 operator-() const {
        return BaseVector2(-x, -y);
    }
    constexpr G operator*(BaseVector2 a) const {
        return G(x) * a.x &#43; G(y) * a.y;
    }
    constexpr G operator%(BaseVector2 a) const {
        return G(x) * a.y - G(y) * a.x;
    }
    constexpr BaseVector2 rotate() const {
        return BaseVector2(-y, x);
    }
    template&lt;class Float&gt;
    constexpr BaseVector2 rotate(Float theta) const {
        BaseVector2 b(cosl(theta), sinl(theta));
        return BaseVector2(x * b.x - y * b.y,
                           x * b.y &#43; y * b.x);
    }
    constexpr friend BaseVector2 operator*(const T &amp;a, BaseVector2 b) {
        return BaseVector2(a * b.x, a * b.y);
    }

    // 比较
    constexpr bool operator&lt;(BaseVector2 a) const {
        if (x == a.x) {
            return y &lt; a.y;
        }
        return x &lt; a.x;
    }

    constexpr bool operator&gt;(BaseVector2 a) const {
        if (x == a.x) {
            return y &gt; a.y;
        }
        return x &gt; a.x;
    }

    constexpr bool operator&lt;=(BaseVector2 a) const {
        if (x == a.x) {
            return y &lt;= a.y;
        }
        return x &lt;= a.x;
    }

    constexpr bool operator&gt;=(BaseVector2 a) const {
        if (x == a.x) {
            return y &gt;= a.y;
        }
        return x &gt;= a.x;
    }

    constexpr bool operator==(BaseVector2 a) const {
        return x == a.x and y == a.y;
    }

    constexpr bool operator!=(BaseVector2 a) const {
        return x != a.x or y != a.y;
    }

    // 输入输出
    friend std::istream &amp;operator&gt;&gt;(std::istream &amp;in, BaseVector2 &amp;p) {
        return in &gt;&gt; p.x &gt;&gt; p.y;
    }
    friend std::ostream &amp;operator&lt;&lt;(std::ostream &amp;ot, BaseVector2 p) {
        return ot &lt;&lt; &#39;(&#39; &lt;&lt; p.x &lt;&lt; &#34;, &#34; &lt;&lt; p.y &lt;&lt; &#39;)&#39;;
    }
};

template &lt;class T, class G&gt;
G dis2(BaseVector2&lt;T, G&gt; a, BaseVector2&lt;T, G&gt; b = BaseVector2&lt;T, G&gt;(0, 0)) {
    BaseVector2&lt;T, G&gt; p = a - b;
    return p * p;
}
template &lt;class T, class G&gt;
auto dis(BaseVector2&lt;T, G&gt; a, BaseVector2&lt;T, G&gt; b = BaseVector2&lt;T, G&gt;(0, 0)) {
    return sqrtl(dis2(a, b));
}

template &lt;class T, class G&gt;
int sgn(BaseVector2&lt;T, G&gt; p) {
    if (p.x &lt; 0 or p.x == 0 and p.y &gt; 0) {
        return 1;
    } else
        return 0;
    // 以41象限为先
}

template &lt;class Vector&gt;
bool polarCmp(Vector p, Vector q) {
    if (sgn(p) == sgn(q)) {
        if (p % q == 0) {
            return dis2(p) &lt; dis2(q);
        } else {
            return p % q &gt; 0;
        }
    } else {
        return sgn(p) &lt; sgn(q);
    }
}

using Point = BaseVector2&lt;int, i64&gt;;
using Vector = Point;
using PS = std::vector&lt;Point&gt;;</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="有关线的操作">有关线的操作</h3>
<p>
  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Point - Line</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">// a on Seg b-c
bool onSeg(Point a, Point b, Point c) {
    b = b - a, c = c - a;
    return b % c == 0 and b * c &lt;= 0;
}

// a disTo Line b-c
ld disToLine(Point a, Point b, Point c) {
    Point v1 = b - c, v2 = a - c;
    return 1.L * std::abs(v1 % v2) / sqrtl(v1 * v1);
}

// a disTo Seg b-c
ld disToSeg(Point a, Point b, Point c) {
    if ((a - b) * (c - b) &lt;= 0 or (a - c) * (b - c) &lt;= 0) {
        return std::min(dis(a, b), dis(a, c));
    }
    return disToLine(a, b, c);
}

// a project to Line b-c (here Point = Point&lt;ld, ld&gt;)
Point foot(Point a, Point b, Point c) {
    Point u = a - b, v = c - b;
    return b &#43; 1.L * (u * v) / (v * v) * v;
}

// a symmetry to Line b-c (here Point = Point&lt;ld, ld&gt;)
Point symmetry(Point a, Point b, Point c) {
    Point ft = foot(a, b, c);
    return 2 * ft - a;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Line - Line</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">// Line a-b cross Line c-d (here Point = Point&lt;ld, ld&gt;)
Point cross(Point a, Point b, Point c, Point d) {
    Point v = c - d;
    ld sa = v % (a - d), sb = (b - d) % v;
    return 1.L * sa / (sa &#43; sb) * (b - a) &#43; a;
}

const ld pi = acosl(-1);
// a-b 和 a-c 的夹角 signed
ld getAngle(Point a, Point b, Point c) {
    auto v1 = b - a, v2 = c - a;
    return atan2l(v1 % v2, v1 * v2); // ∠bac
}

int sgn(const ld &amp;a) {
    return (a &lt; -eps ? -1 : a &gt; eps);
}

// 对四个不同的点判断四点共圆
// d在abc外接圆外return 1, 内return -1
int inCircle(Point a, Point b, Point c, Point d) {
    ld ag1 = getAngle(a, b, c), ag2 = getAngle(d, c, b);
    if (sgn(ag1) == sgn(ag2)) {
        return sgn(PI - std::abs(ag1 &#43; ag2));
    } else {
        return sgn(std::abs(ag1) - std::abs(ag2));
    }
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details></p>
<h3 id="多边形">多边形</h3>
<p>
  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">凸包</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">PS convex(PS ps) {
    std::sort(ps.begin(), ps.end());
    ps.erase(std::unique(ps.begin(), ps.end()), ps.end());

    const int n = ps.size();
    if (n &lt;= 1) {
        return ps;
    }

    PS hull(n &#43; 1);
    int k = -1;

    for (int i = 0; i &lt; n; i&#43;&#43;) {
        while (k &gt;= 1 and (hull[k] - hull[k - 1]) % (ps[i] - hull[k]) &lt;= 0) {
            k -= 1;
        }
        hull[&#43;&#43;k] = ps[i];
    }

    for (int i = n - 2, m = k &#43; 1; i &gt;= 0; i--) {
        while (k &gt;= m and (hull[k] - hull[k - 1]) % (ps[i] - hull[k]) &lt;= 0) {
            k -= 1;
        }
        hull[&#43;&#43;k] = ps[i];
    }

    assert(k &gt;= 2);
    return hull.resize(k), hull;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">求凸包面积</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">ld area(const PS &amp;ps) {
    ld res = 0;
    for (int i = 0; i &lt; ps.size(); i&#43;&#43;) {
        int j = (i &#43; 1) % ps.size();
        res &#43;= ps[i] % ps[j];
    }
    return res / 2;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Point - Polygon</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">// #include &#34;onSeg&#34;

class InPoly {
    // Seg c-d is Cross Seg a-b
    bool isCross(Point a, Point b, Point c, Point d) const {
        Vector ab = b - a, cd = d - c;
        if (ab % cd == 0)
            return 0; // 共线,寄
        int r1 = sgn(ab % (c - a)), r2 = sgn(ab % (d - a));
        int g1 = sgn(cd % (a - c)), g2 = sgn(cd % (b - c));
        return !(r1 * r2 &gt; 0 or r1 &#43; r2 == -1 or g1 * g2 &gt; 0);
        // 真相交或者 c-d 贴着 a-b 左边
    }

public:
    // a IN/OUT/ON Polygon
    std::string operator()(Point a, const PS &amp;ps) const {
        int res = 0;
        Vector b = {1 &lt;&lt; 30, a.y};
        for (int i = 0; i &lt; ps.size(); i&#43;&#43;) {
            int j = (i &#43; 1) % ps.size();
            if (onSeg(a, ps[i], ps[j]))
                return &#34;ON&#34;;
            res &#43;= isCross(a, b, ps[i], ps[j]);
        }
        return (res % 2 ? &#34;IN&#34; : &#34;OUT&#34;);
    }
};
const InPoly inPoly;

// a IN/OUT/ON Convex
std::string inConvex(Point a, const PS &amp;ps) {
    if (a == ps[0])
        return &#34;ON&#34;;
    if (ps.size() &lt;= 1)
        return &#34;OUT&#34;;
    if (ps.size() == 2)
        return onSeg(a, ps[0], ps[1]) ? &#34;ON&#34; : &#34;OUT&#34;;
    auto v = a - ps[0];
    if ((ps[1] - ps[0]) % v &lt; 0 or (ps.back() - ps[0]) % v &gt; 0)
        return &#34;OUT&#34;;
    int l = 1, r = ps.size() - 1;
    while (l &#43; 1 &lt; r) {
        auto mid = l &#43; r &gt;&gt; 1;
        auto res = (ps[mid] - ps[0]) % v;
        if (res == 0)
            return (ps[mid] == a ? &#34;ON&#34; : (onSeg(a, ps[0], ps[mid]) ? &#34;IN&#34; : &#34;OUT&#34;));
        (res &gt; 0 ? l : r) = mid;
    }
    auto res = (ps[r] - ps[l]) % (a - ps[l]);
    if (res == 0 or onSeg(a, ps[0], ps[l]) or onSeg(a, ps[0], ps[r]))
        return &#34;ON&#34;;
    return (res &gt; 0 ? &#34;IN&#34; : &#34;OUT&#34;);
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Line - Polygon</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">PS cutPoly(const PS &amp;ps, Point a, Point b) {
    // 返回多边形 ps 在有向直线 a-&gt;b 左边的部分
    PS v;
    auto c = b - a;
    for (int i = 0; i &lt; ps.size(); i&#43;&#43;) {
        int j = (i &#43; 1) % ps.size();
        auto cr1 = c % (ps[i] - a), cr2 = c % (ps[j] - a);
        if (cr1 &gt;= 0)
            v.push_back(ps[i]);
        if (sgn(cr1) * sgn(cr2) == -1)
            v.push_back(cross(a, b, ps[i], ps[j]));
    }
    return v;
}


// find point of tangency
class BinarySearchOnConvex {
    PS vs;

public:
    constexpr BinarySearchOnConvex(const PS &amp;ps) : vs(ps.size()) {
        int n = size(ps);
        for (int i = 0; i &lt; n; i&#43;&#43;) {
            int j = (i &#43; 1) % n;
            vs[i] = ps[j] - ps[i];
        }
    }

    int operator()(Point a) const {
        int res = std::lower_bound(begin(vs), end(vs), a, polarCmp) - begin(vs);
        return res % size(vs);
    }
};</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">求两凸包闵可夫斯基和</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">PS minkowski(const PS &amp;a, const PS &amp;b) {
    int n = a.size(), m = b.size();
    if (!n or !m)
        return PS();

    PS ps(1, a[0] &#43; b[0]);
    int ap = 0, bp = 0;
    while (ap &lt; n and bp &lt; m) {
        auto va = a[(ap &#43; 1) % n] - a[ap];
        auto vb = b[(bp &#43; 1) % m] - b[bp];
        auto res = va % vb;
        if (res &gt; 0)
            ps.push_back(ps.back() &#43; va), ap&#43;&#43;;
        if (res &lt; 0)
            ps.push_back(ps.back() &#43; vb), bp&#43;&#43;;
        if (res == 0)
            ps.push_back(ps.back() &#43; va &#43; vb), ap&#43;&#43;, bp&#43;&#43;;
    }
    while (ap &lt; n) {
        auto va = a[(ap &#43; 1) % n] - a[ap];
        ps.push_back(ps.back() &#43; va), ap&#43;&#43;;
    }
    while (bp &lt; m) {
        auto vb = b[(bp &#43; 1) % m] - b[bp];
        ps.push_back(ps.back() &#43; vb), bp&#43;&#43;;
    }
    return ps.pop_back(), ps;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details></p>
<h3 id="一些具体应用">一些具体应用</h3>
<p>
  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">最小圆覆盖</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">//需要cross（在Line - Line里）
Point excir(const Point &amp;a, const Point &amp;b, const Point &amp;c) {
    // 三点求外接圆 圆心
    auto d1 = 0.5 * (a &#43; b), d2 = d1 &#43; (a - b).rotate();
    auto d3 = 0.5 * (c &#43; b), d4 = d3 &#43; (c - b).rotate();
    return cross(d1, d2, d3, d4);
}

struct MinCircleOver {
    pii Center;
    ld Radius = 0;

    MinCircleOver(PS ps) {
        std::shuffle(begin(ps), end(ps), std::mt19937(time(0)));

        for (int i = 0; i &lt; ps.size(); i&#43;&#43;) {
            if (sgn(dis(Center, ps[i]) - Radius) &lt;= 0)
                continue;
            // i点不在圆内,说明 i要更新圆
            Center = ps[i], Radius = 0;
            for (int j = 0; j &lt; i; j&#43;&#43;) {
                if (sgn(dis(Center, ps[j]) - Radius) &lt;= 0)
                    continue;
                // j不在圆内,说明 j要更新圆
                Center = 0.5f * (ps[i] &#43; ps[j]), Radius = dis(Center, ps[i]);
                for (int k = 0; k &lt; j; k&#43;&#43;) {
                    if (sgn(dis(Center, ps[k]) - Radius) &lt;= 0)
                        continue;
                    // k不在圆内,说明 k要更新圆
                    Center = excir(ps[i], ps[j], ps[k]), Radius = dis(Center, ps[i]);
                }
            }
        }
    }
};</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">平面最近点对</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">
// 得到平面最近点对距离的平方
template &lt;class T, class G&gt;
G closestPair(std::vector&lt;Point&lt;T, G&gt;&gt; ps) {
    auto pf = [&amp;](const T &amp;x) {
        return 1ll * x * x;
    };

    G ans = 1ll &lt;&lt; 60;
    std::function&lt;void(int, int)&gt; find = [&amp;](int l, int r) {
        if (r - l &lt;= 1)
            return;
        int mid = l &#43; r &gt;&gt; 1;
        find(l, mid), find(mid, r);

        std::vector&lt;Point&lt;T, G&gt;&gt; b; // points in caught
        for (int i = l; i &lt; r; i&#43;&#43;)
            if (pf(std::fabs(ps[i].x - ps[mid].x)) &lt; ans)
                b.push_back(ps[i]);

        std::sort(b.begin(), b.end(), [&amp;](pii u, pii v) {
            return u.y &lt; v.y; // sort by y
        });

        for (int i = 0; i &lt; b.size(); i&#43;&#43;)
            for (int j = i &#43; 1; j &lt; b.size() and pf(b[j].y - b[i].y) &lt; ans; j&#43;&#43;)
                ans = std::min(ans, dis2(b[j] - b[i]));
    };
    std::sort(begin(ps), end(ps)); // sort by x
    find(0, ps.size());

    return ans;
}
// O(nlog2n) but almost O(nlogn)</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">三角剖分</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">const ld pi = acosl(-1);
// a-b 和 a-c 的夹角 signed
ld getAngle(Point a, Point b, Point c) {
    auto v1 = b - a, v2 = c - a;
    return atan2l(v1 % v2, v1 * v2); // ∠bac
}

// 对四个不同的点判断四点共圆
// d在abc外接圆外return 1, 内return -1
int inCircle(Point a, Point b, Point c, Point d) {
    auto ag1 = getAngle(a, b, c), ag2 = getAngle(d, c, b);
    if (sgn(ag1) == sgn(ag2)) {
        return sgn(pi - std::abs(ag1 &#43; ag2));
    } else {
        return sgn(std::abs(ag1) - std::abs(ag2));
    }
}

struct Delaunay {
    struct Edge {
        Edge *l, *r, *inv;
        int face, from;

        Edge() : face{0}, from{-1} {
            l = r = inv = nullptr;
        }
    };

    void addFace(Edge *e0, Edge *e1, Edge *e2, int fid) {
        e0-&gt;r = e2-&gt;l = e1;
        e1-&gt;r = e0-&gt;l = e2;
        e2-&gt;r = e1-&gt;l = e0;

        e0-&gt;face = e1-&gt;face = e2-&gt;face = fid;
        face[fid] = e0;
    }

    void init() {
        bucket.resize(2 * (n &#43; 1));
        vertex.resize(n &#43; 3);

        // 加三个点构造全局三角形
        ps.emplace_back(Inf * 10, Inf);
        ps.emplace_back(-Inf, Inf);
        ps.emplace_back(-Inf, -Inf * 10);

        std::vector&lt;Edge *&gt; e(6);
        for (auto &amp;pt : e) {
            pt = new Edge();
        }

        e[0]-&gt;from = e[5]-&gt;from = n;
        e[1]-&gt;from = e[3]-&gt;from = n &#43; 1;
        e[2]-&gt;from = e[4]-&gt;from = n &#43; 2;

        for (int i = 0; i &lt; 3; i&#43;&#43;) {
            e[i]-&gt;inv = e[i &#43; 3];
            e[i &#43; 3]-&gt;inv = e[i];
        }

        face.resize(2);
        addFace(e[0], e[1], e[2], 0);
        addFace(e[5], e[4], e[3], 1);

        for (int i = 0; i &lt; 3; i&#43;&#43;)
            vertex[i &#43; n] = e[i];

        bucket[1].resize(n);
        std::iota(begin(bucket[1]), end(bucket[1]), 0);
        belong.assign(n, 1);
    }

    std::vector&lt;Edge *&gt; vertex, face;
    std::vector&lt;std::vector&lt;int&gt;&gt; bucket;
    std::vector&lt;int&gt; belong;
    PS ps;
    const int n;

    static constexpr int Inf = int(1e8);
    Delaunay(const PS &amp;initPs) : n{(int)initPs.size()}, ps(initPs) {
        init();

        for (int i = 0; i &lt; n; i&#43;&#43;) {
            addPoint(i);

            Edge *e = vertex[i];
            for (int j = 0; j &lt; 3; j&#43;&#43;) {
                if (flip(i, e-&gt;r-&gt;inv)) {
                    e = e-&gt;l-&gt;inv;
                    j -= 2;
                } else {
                    e = e-&gt;inv-&gt;r;
                }
            }
        }
    }

    bool inFace(Point p, int fid) {
        int cnt = 0;
        Edge *e = face[fid];
        do {
            auto a = ps[e-&gt;from];
            e = e-&gt;r;
            auto b = ps[e-&gt;from];

            cnt &#43;= (b - a) % (p - a) &gt; 0;
        } while (e != face[fid]);

        return cnt == 3 or cnt == 0;
    }

    void addPoint(int pid) {
        int fid[3] = {belong[pid], face.size(), face.size() &#43; 1};

        auto pointS = bucket[fid[0]];
        bucket[fid[0]].clear();

        face.resize(face.size() &#43; 2);

        std::vector&lt;Edge *&gt; e(6);
        for (int i = 0; i &lt; 6; i&#43;&#43;) {
            e[i] = new Edge();
        }
        for (int i = 0; i &lt; 6; i&#43;&#43;) {
            e[i]-&gt;inv = e[i ^ 1];
        }

        e[1]-&gt;from = e[3]-&gt;from = e[5]-&gt;from = pid;
        Edge *tmpe = face[fid[0]];
        int r = 0, l = 5;
        for (int j = 0; j &lt; 3; j&#43;&#43;) {
            Edge *tmpr = tmpe-&gt;r;

            int b = tmpr-&gt;from;
            e[r]-&gt;from = b;

            addFace(e[l], tmpe, e[r], fid[j]);

            r = (r &#43; 2) % 6, l = (l &#43; 2) % 6;
            tmpe = tmpr;
        }

        vertex[pid] = e[1];

        for (int p : pointS) {
            if (p == pid)
                continue;
            for (int j = 0; j &lt; 3; j&#43;&#43;) {
                if (inFace(ps[p], fid[j])) {
                    belong[p] = fid[j];
                    bucket[fid[j]].push_back(p);
                    break;
                }
            }
        }
    }

    bool flip(int pid, Edge *e) {
        if (e-&gt;face == 0)
            return false;

        auto fir = e-&gt;inv-&gt;l;

        int inCircleRes = inCircle(ps[pid], ps[fir-&gt;r-&gt;from],
                                   ps[fir-&gt;l-&gt;from], ps[e-&gt;l-&gt;from]);

        if (inCircleRes &gt;= 0)
            return false;

        int fid[2] = {fir-&gt;face, e-&gt;face};

        auto pointS = bucket[fid[0]];
        pointS.insert(pointS.end(), bucket[fid[1]].begin(), bucket[fid[1]].end());

        bucket[fid[0]].clear();
        bucket[fid[1]].clear();

        auto ev = e-&gt;inv;
        auto sec = e-&gt;r, thir = e-&gt;l, four = fir-&gt;l;

        addFace(fir, sec, ev, fid[0]);
        addFace(e, thir, four, fid[1]);
        e-&gt;from = pid;
        ev-&gt;from = thir-&gt;from;

        for (int p : pointS) {
            for (int j = 0; j &lt; 2; j&#43;&#43;) {
                if (inFace(ps[p], fid[j])) {
                    belong[p] = fid[j];
                    bucket[fid[j]].push_back(p);
                    break;
                }
            }
        }
        return true;
    }
};</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details></p>
<h3 id="点三维">点（三维）</h3>
<p>
  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Point (3D)</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">template &lt;class T, class G&gt;
struct BaseVector3 {
    T x, y, z;

    constexpr BaseVector3() : BaseVector3(T{}, T{}, T{}) {}

    constexpr BaseVector3(T x, T y, T z)
        : x{x}, y{y}, z{z} {}

    constexpr BaseVector3 operator-(BaseVector3 a) const {
        return BaseVector3(x - a.x, y - a.y, z - a.z);
    }

    constexpr BaseVector3 operator-() const {
        return BaseVector3(-x, -y, -z);
    }

    constexpr BaseVector3 operator&#43;(BaseVector3 a) const {
        return BaseVector3(x &#43; a.x, y &#43; a.y, z &#43; a.z);
    }

    constexpr G operator*(BaseVector3 a) const {
        return x * a.x &#43; y * a.y &#43; z * a.z;
    }

    constexpr BaseVector3 operator%(BaseVector3 a) const {
        return BaseVector3(
            y * a.z - a.y * z,
            a.x * z - x * a.z,
            x * a.y - a.x * y);
    }

    constexpr friend BaseVector3 operator*(T d, BaseVector3 a) {
        return BaseVector3(d * a.x, d * a.y, d * a.z);
    }

    constexpr friend bool sameLine(BaseVector3 a, BaseVector3 b) {
        return dis2(a % b) == 0;
    }

    constexpr friend bool sameDir(BaseVector3 a, BaseVector3 b) {
        return samLine(a, b) and a * b &gt;= 0;
    }

    // 字典序
    constexpr bool operator&lt;(BaseVector3 a) const {
        if (x != a.x)
            return x &lt; a.x;
        if (y != a.y)
            return y &lt; a.y;
        return z &lt; a.z;
    }

    constexpr bool operator==(BaseVector3 a) const {
        return x == a.x and y == a.y and z == a.z;
    }

    constexpr friend auto &amp;operator&gt;&gt;(std::istream &amp;is, BaseVector3 &amp;p) {
        return is &gt;&gt; p.x &gt;&gt; p.y &gt;&gt; p.z;
    }
    constexpr friend auto &amp;operator&lt;&lt;(std::ostream &amp;os, BaseVector3 p) {
        return os &lt;&lt; &#39;(&#39; &lt;&lt; p.x &lt;&lt; &#34;, &#34; &lt;&lt; p.y &lt;&lt; &#34;, &#34; &lt;&lt; p.z &lt;&lt; &#39;)&#39;;
    }
};

template &lt;class T, class G&gt;
G dis2(BaseVector3&lt;T, G&gt; a, BaseVector3&lt;T, G&gt; b = BaseVector3&lt;T, G&gt;{}) {
    auto p = a - b;
    return p * p;
}
template &lt;class T, class G&gt;
auto dis(BaseVector3&lt;T, G&gt; a, BaseVector3&lt;T, G&gt; b = BaseVector3&lt;T, G&gt;{}) {
    return sqrtl(dis2(a, b));
}

template &lt;class T, class G&gt;
auto area(BaseVector3&lt;T, G&gt; a, BaseVector3&lt;T, G&gt; b = BaseVector3&lt;T, G&gt;{}) {
    return dis(a % b) / 2;
}

template &lt;class T&gt;
struct TrianglePatch {
    std::array&lt;T, 3&gt; vertexs;

    constexpr TrianglePatch() : vertexs{} {}

    constexpr TrianglePatch(T u, T v, T w)
        : vertexs({u, v, w}) {}

    constexpr T &amp;operator[](int i) {
        return vertexs[i];
    }

    constexpr T normal() const {
        return (vertexs[1] - vertexs[0]) % (vertexs[2] - vertexs[0]);
    }

    constexpr T vectorTo(T a) const {
        return a - vertexs[0];
    }

    constexpr auto area() const {
        return ::area(vertexs[1] - vertexs[0], vertexs[2] - vertexs[0]);
    }

    constexpr bool coPlane(T a) const {
        return vectorTo(a) * normal() == 0;
    }

    constexpr bool left(T a) const {
        return vector(a) * normal() &gt; 0;
    }

    constexpr bool contains(T a) const {
        if (!coPlane(a)) {
            return false;
        }

        T norm = normal();
        int leftCnt = 0;

        for (int i = 0; i &lt; 3; i&#43;&#43;) {
            T edge = vertexs[(i &#43; 1) % 3] - vertexs[i];
            T to_a = a - vertexs[i];

            leftCnt &#43;= sameDir(edge % to_a, norm);
        }

        return leftCnt == 3;
    }
};

using Point = BaseVector3&lt;Float, Float&gt;;
using Vector = Point;

using PS = std::vector&lt;Point&gt;;
using PatchS = std::vector&lt;TrianglePatch&lt;Point&gt;&gt;;</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">三维凸包</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">PatchS convex(PS ps) {
    std::sort(begin(ps), end(ps));
    ps.erase(std::unique(ps.begin(), ps.end()), ps.end());
    // 去除重复点

    const int n = ps.size();

    if (n &lt; 4) {
        return {};
    }

    std::vector vis(n, std::vector&lt;int&gt;(n, -1));
    using IndexPatch = std::array&lt;int, 3&gt;;

    std::vector&lt;IndexPatch&gt; pls(2);
    pls[0] = IndexPatch{0, 1, 2};
    pls[1] = IndexPatch{0, 2, 1};

    auto isAbove = [&amp;](Point p, IndexPatch &amp;pl) {
        auto vec = (ps[pl[1]] - ps[pl[0]]) % (ps[pl[2]] - ps[pl[0]]);
        return vec * (p - ps[pl[0]]) &gt;= 0;
    };

    for (int i = 3; i &lt; n; i&#43;&#43;) {
        std::vector&lt;IndexPatch&gt; res, del;
        for (int j = 0; j &lt; size(pls); j&#43;&#43;) {
            if (!isAbove(ps[i], pls[j])) {
                res.push_back(pls[j]);
            } else {
                del.push_back(pls[j]);
                for (int k = 0; k &lt; 3; k&#43;&#43;) {
                    int r = (k &#43; 1) % 3;
                    vis[pls[j][k]][pls[j][r]] = i;
                }
            }
        }
        for (auto pl : del) {
            for (int k = 0; k &lt; 3; k&#43;&#43;) {
                int r = (k &#43; 1) % 3;
                if (vis[pl[k]][pl[r]] == i and vis[pl[r]][pl[k]] != i) {
                    res.push_back({pl[k], pl[r], i});
                }
            }
        }
        std::swap(res, pls);
    }

    PatchS ans;
    for (auto pl : pls) {
        ans.push_back({ps[pl[0]], ps[pl[1]], ps[pl[2]]});
    }

    return ans;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details></p>
<h2 id="其他">其他</h2>
<h3 id="离散化">离散化</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">Discreter</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">template&lt;typename T&gt;//    原数组               离散化后数组   离散化后的元素对应的原始元素
void Discrete(std::vector&lt;T&gt;&amp; a, std::vector&lt;int&gt;&amp; da, std::vector&lt;T&gt;&amp; v) {
    v = a;
    std::sort(v.begin(), v.end());
    v.erase(std::unique(v.begin(), v.end()), v.end());

    std::map&lt;T, int&gt; mp;
    for (int i = 0; i &lt; v.size(); i&#43;&#43;) {
        mp[v[i]] = i;
    }

    da.resize(a.size());
    for (int i = 0; i &lt; a.size(); i&#43;&#43;) {
        da[i] = mp[a[i]];
    }
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="高精">高精</h3>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">BINT</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">struct BINT{
    int len=0;
    int w[5000];//最大开到多少位
    BINT(){}
    BINT(ll base){
        while(base){
            w[&#43;&#43;len]=base%10;
            base/=10;
        }
    }
    void jw(){//处理进位
        FOR(i,1,len){
            if(w[i]&gt;=10){
                w[i&#43;1]&#43;=w[i]/10;
                w[i]%=10;
                if(w[len&#43;1])len&#43;&#43;;
            }
        }
    }
    BINT operator&#43;(BINT b){//高精加法
        FOR(i,1,max(len,b.len)){
            b.w[i]&#43;=w[i];
        }
        b.jw();
        return b;
    }
};
ostream&amp; operator&lt;&lt;(ostream &amp;COUT,BINT a){
    rFOR(i,a.len,1){
        COUT&lt;&lt;a.w[i];
    }
    return COUT;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>
<h3 id="最大子矩形">最大子矩形</h3>
<p>给定方格图，图上有一些障碍点，求最大子矩形，内部不含障碍点

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">MaxSubRect（O(s^2)）</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">
i64 MaxSubRect(int n, int m, std::vector&lt;std::pair&lt;int, int&gt;&gt; nod) {//O(s^2)
    nod.emplace_back(n, 0);
    nod.emplace_back(n, m);
    nod.emplace_back(0, m);
    nod.emplace_back(0, 0);
    i64 ans = 0;
    std::sort(nod.begin(), nod.end(), [](const std::pair&lt;int, int&gt;&amp; a, const std::pair&lt;int, int&gt;&amp; b){
        if (a.first != b.first) return a.first &lt; b.first;
        return a.second &lt; b.second;
    });
    int s = nod.size();
    for (int i = 0; i &lt; s; &#43;&#43;i){
        int h1 = m, h2 = 0, k = n - nod[i].first, flag = 0;
        for (int j = i &#43; 1; j &lt; s; &#43;&#43;j) {
            if (nod[j].second &lt;= h1 &amp;&amp; nod[j].second &gt;= h2) {
                if (k * (h1 - h2) &lt;= ans) break;//剪枝：如果走到边界的距离乘高都比现有答案小，break

                ans = std::max(ans, 1ll * (h1 - h2) * (nod[j].first - nod[i].first));
                if (nod[i].second == nod[j].second) {//如果高度相同，可以直接break且不用考虑边界
                    flag = 1;
                    break;
                }
                if (nod[j].second &gt; nod[i].second)
                    h1 = std::min(h1, nod[j].second);
                else
                    h2 = std::max(h2, nod[j].second);
            }
        }
        if (!flag) ans = std::max(ans, 1ll * k * (h1 - h2));//枚举障碍点,默认向右只能到达最右边的障碍点，而不是右边界，所以应该考虑直接往右边界走的情况
            
        h1 = m, h2 = 0, k = nod[i].first, flag = 0;
        for (int j = i - 1; j &gt;= 0; --j) {//往左走，类似
            if (nod[j].second &lt;= h1 &amp;&amp; nod[j].second &gt;= h2) {
                if (k * (h1 - h2) &lt;= ans) break;
                ans = std::max(ans, 1ll * (h1 - h2) * (nod[i].first - nod[j].first));
                if (nod[i].second == nod[j].second) {
                    flag = 1;
                    break;
                }
                if (nod[j].second &gt; nod[i].second)
                    h1 = std::min(h1, nod[j].second);
                else
                    h2 = std::max(h2, nod[j].second);
            }
        }
        if (!flag) ans = std::max(ans, 1ll * k * (h1 - h2));
    }
    std::sort(nod.begin(), nod.end(), [](std::pair&lt;int, int&gt; a, std::pair&lt;int, int&gt; b) {
        if (a.second != b.second) return a.second &lt; b.second;
        return a.first &lt; b.first;
    }); //考虑两边都是边界
    for (int i = 0; i &lt; s - 1; &#43;&#43;i)
        ans = std::max(ans, 1ll * n * (nod[i &#43; 1].second - nod[i].second));
    return ans;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details>

  
    
  
  
  
  



<details class="custom-block details" style="display: block; position: relative; border-radius: 10px; margin: 0.0em 0px; padding: 0.6em; background-color: rgb(238, 238, 238); color: rgb(44, 62, 80); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="outline: none; cursor: pointer;">MaxSubRect（O(nm)）</summary>
  <table>
    <tbody>
      <div style="display: flex;">
        <div class="gutter" style="flex-grow: 1; line-height: 1.45;font-size: 1.4rem;">
          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre>
        </div>
        <div class="code" style="flex-shrink: 1; line-height: 1.45;font-size: 1.44rem;">
          <pre class="code-highlight language- "><code class=" codeblock hljs cpcode" style="border-radius: 5px; width : 700px;">i64 MaxSubRect(std::vector&lt;std::vector&lt;bool&gt;&gt; &amp;mmap) {//O(nm)
    int n = mmap.size() - 1, m = mmap[0].size() - 1;
    std::vector&lt;std::vector&lt;int&gt;&gt; h(n &#43; 1, std::vector&lt;int&gt;(m &#43; 1)), l = h, r = h;
    for (int i = 1; i &lt;= n; &#43;&#43;i) {
        for (int j = 1; j &lt;= m; &#43;&#43;j) {
            h[i][j] = 1;
            if (i &gt; 1 &amp;&amp; !mmap[i - 1][j] &amp; !mmap[i][j])
                h[i][j] = h[i - 1][j] &#43; 1;
            l[i][j] = j;
            r[i][j] = j;
        }
        for (int j = 1; j &lt;= m - 1; &#43;&#43;j)
            if (!mmap[i][j] &amp; !mmap[i][j &#43; 1])
                l[i][j &#43; 1] = l[i][j];
        for (int j = m - 1; j &gt;= 1; --j)
            if (!mmap[i][j] &amp; !mmap[i][j &#43; 1])
                r[i][j] = r[i][j &#43; 1];
    }
    i64 ans = 0;
    for (int i = 1; i &lt;= n; &#43;&#43;i)
        for (int j = 1; j &lt;= m; &#43;&#43;j) {
            if (i &gt; 1 &amp;&amp; !mmap[i - 1][j] &amp; !mmap[i][j]) {
                l[i][j] = std::max(l[i - 1][j], l[i][j]);
                r[i][j] = std::min(r[i - 1][j], r[i][j]);
            }
            if (!mmap[i][j])
                ans = std::max(ans, 1ll * (r[i][j] - l[i][j] &#43; 1) * h[i][j]);
        }
    return ans;
}</code></pre>
        </div>
      </div>
    </tbody>
  </table>
</details></p>
<h3 id="优先队列维护前k大的数">优先队列维护前k大的数</h3>
<p>这里封成struct了，当然，你直接用主要逻辑也行，不封装也行。</p>
<pre><code class="language-cpp">template&lt;typename T&gt; struct BUCKET{
    int k;
    priority_queue&lt;T,vector&lt;T&gt;,greater&lt;T&gt;&gt; q;//前k大（改成less即为前k小）
    BUCKET(int k_){k=k_;}
    void push(T x){
        if(q.size()&gt;=k){
            if(q.top()&lt;x){q.pop();q.push(x);}//前k大（改成&gt;即为前k小）
        }else q.push(x);
    }
    vector&lt;T&gt; get(){
        vector&lt;T&gt; out;
        while(!q.empty()){out.push_back(q.top());q.pop();}
        reverse(out.begin(),out.end());
        return out;
    }
};
//使用方法：
BUCKET&lt;int&gt; buk(k);//创建一个大小为k的桶（我也不知道算不算桶，把它理解成那种往里面加东西，加到桶的容量上限时会溢出来的效果就行）
buk.push(x);//往桶里装东西
auto vec=buk.get();//把桶里的东西倒出来

//特别注意，如果你要用封装的话，T的类型要保证支持
//operator&lt;(T a,T b)
//operator&gt;(T a,T b)
//operator&lt;(const T a,T b)
//operator&gt;(const T a,T b)
//不然会报错
</code></pre>
<pre><code>前面的区域以后再来探索吧！
</code></pre>
              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://xiaoxiauwu.github.io/tags/acm/">ACM</a>

  <a class="tag tag--primary tag--small" href="https://xiaoxiauwu.github.io/tags/%E7%AE%97%E6%B3%95/">算法</a>

                  </div>
                
              
            
            
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://xiaoxiauwu.github.io/post/algorithm/bz/" data-tooltip="倍增及有关例题" aria-label="PREVIOUS: 倍增及有关例题">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://xiaoxiauwu.github.io/post/todolist/" data-tooltip="[置顶] To Do List" aria-label="NEXT: [置顶] To Do List">
          
              <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


            
  
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
    <script type="text/javascript">
      var disqus_config = function() {
        this.page.url = 'https:\/\/xiaoxiauwu.github.io\/post\/template\/';
        
          this.page.identifier = '\/post\/template\/'
        
      };
      (function() {
        
        
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
          document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
          return;
        }
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'hugo-tranquilpeak-theme';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2024 XiaoXia. All Rights Reserved
  </span>


<div class="busuanzi-footer">
  <span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
  </span>
  <span id="busuanzi_container_site_uv">
    本站访客数<span id="busuanzi_value_site_uv"></span>人次
  </span>
</div></footer>
      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://xiaoxiauwu.github.io/post/algorithm/bz/" data-tooltip="倍增及有关例题" aria-label="PREVIOUS: 倍增及有关例题">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://xiaoxiauwu.github.io/post/todolist/" data-tooltip="[置顶] To Do List" aria-label="NEXT: [置顶] To Do List">
          
              <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


      </div>
      

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://xiaoxiauwu.github.io/images/avatar.jpg" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">XiaoXia</h4>
    
      <div id="about-card-bio">憧憬着未来却虚度着当下，到头来自己也只是一片空虚吧<strong>LIVE IN THE MOMENT</strong></div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        学生
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        华南理工大学
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://xiaoxiauwu.github.io/images/cover_.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js" integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://xiaoxiauwu.github.io/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>


  
    <script async crossorigin="anonymous" defer integrity="sha512-gE8KAQyFIzV1C9+GZ8TKJHZS2s+n7EjNtC+IMRn1l5+WYJTHOODUM6JSjZhFhqXmc7bG8Av6XXpckA4tYhflnw==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/apache.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-EWROca+bote+7Oaaar1F6y74iZj1r1F9rm/ly7o+/FwJopbBaWtsFDmaKoZDd3QiGU2pGacBirHJNivmGLYrow==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/go.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-GDVzAn0wpx1yVtQsRWmFc6PhJiLBPdUic+h4GWgljBh904O3JU10fk9EKNpVyIoPqkFn54rgL2QBG4BmUTMpiQ==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/http.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-UgZlma8NzkrDb/NWgmLIcTrH7i/CSnLLDRFqCSNF5NGPpjKmzyM25qcoXGOup8+cDakKyaiTDd7N4dyH4YT+IA==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/less.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-lot9koe73sfXIrUvIPM/UEhuMciN56RPyBdOyZgfO53P2lkWyyXN7J+njcxIIBRV+nVDQeiWtiXg+bLAJZDTfg==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/nginx.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-Zd3e7XxHP00TD0Imr0PIfeM0fl0v95kMWuhyAS3Wn1UTSXTkz0OhtRgBAr4JlmADRgiXr4x7lpeUdqaGN8xIog==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/puppet.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-qtqDO052iXMSP+5d/aE/jMtL9vIIGvONgTJziC2K/ZIB1yEGa55WVxGE9/08rSQ62EoDifS9SWVGZ7ihSLhzMA==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/scss.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-1NmkjnEDnwwwcu28KoQF8vs3oaPFokQHbmbtwGhFfeDsQZtVFI8zW2aE9O8yMYdpdyKV/5blE4pSWw4Z/Sv97w==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/stylus.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-B2wSfruPjr8EJL6IIzQr1eAuDwrsfIfccNf/LCEdxELCgC/S/ZMt/Uvk80aD79m7IqOqW+Sw8nbkvha20yZpzg==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/swift.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-28oDiQZGKUVN6wQ7PSLPNipOcmkCALXKwOi7bnkyFf8QiMZQxG9EQoy/iiNx6Zxj2cG2SbVa4dXKigQhu7GiFw==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/yaml.min.js"></script>
  

  
    <script src="https://xiaoxiauwu.github.io/js/click.js"></script>
  

  
    <script src="https://xiaoxiauwu.github.io/js/sakura.js"></script>
  


<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>




    
  </body>
</html>

